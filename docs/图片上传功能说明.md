# 📸 图片上传功能说明

## 🎯 功能概述

由于 **DeepSeek API 目前不支持图片上传和多模态功能**，我们集成了其他支持视觉功能的 AI 服务来实现图片分析功能。当用户上传题目图片时，系统会自动切换到支持视觉的 AI 服务进行分析。

## 🔧 技术架构

### 混合 AI 服务策略
- **文本对话**：使用 DeepSeek API（成本低、速度快）
- **图片分析**：自动切换到支持视觉的 AI 服务

### 支持的视觉 AI 服务
1. **OpenAI GPT-4 Vision**（推荐）
   - 模型：`gpt-4-vision-preview`
   - 优势：识别准确度高，支持复杂数学公式
   
2. **Google Gemini Vision**
   - 模型：`gemini-pro-vision`
   - 优势：免费额度较高，响应速度快
   
3. **Anthropic Claude Vision**
   - 模型：`claude-3-sonnet-20240229`
   - 优势：理解能力强，适合复杂题目分析

## 📋 配置步骤

### 1. 获取 API 密钥

#### OpenAI API 密钥（推荐）
1. 访问 [OpenAI Platform](https://platform.openai.com/)
2. 注册/登录账户
3. 进入 API Keys 页面
4. 创建新的 API 密钥
5. 复制密钥备用

#### Google Gemini API 密钥
1. 访问 [Google AI Studio](https://makersuite.google.com/)
2. 登录 Google 账户
3. 创建新的 API 密钥
4. 复制密钥备用

#### Anthropic Claude API 密钥
1. 访问 [Anthropic Console](https://console.anthropic.com/)
2. 注册/登录账户
3. 创建 API 密钥
4. 复制密钥备用

### 2. 配置环境变量

在项目根目录的 `.env.local` 文件中添加（至少配置一个）：

```env
# OpenAI GPT-4 Vision（推荐）
NEXT_PUBLIC_OPENAI_API_KEY=your_openai_api_key_here

# Google Gemini Vision
NEXT_PUBLIC_GEMINI_API_KEY=your_gemini_api_key_here

# Anthropic Claude Vision
NEXT_PUBLIC_CLAUDE_API_KEY=your_claude_api_key_here
```

### 3. 重启开发服务器

```bash
npm run dev
```

## 🎨 使用方法

### 1. 上传图片
1. 在聊天界面点击 📷 图片上传按钮
2. 选择图片文件或拖拽图片到上传区域
3. 支持格式：JPG、PNG、WebP
4. 最大文件大小：10MB

### 2. 图片分析
- 系统会自动分析图片内容
- 识别文字、数学公式、图形等
- 提供解题思路和学习建议
- 评估题目难度等级

### 3. 智能问答
- 可以在上传图片的同时输入具体问题
- AI 会结合图片内容和问题进行针对性回答
- 支持多轮对话深入讨论

## ✨ 功能特性

### 🔍 智能识别
- **文字提取**：自动识别图片中的文字内容
- **公式解析**：准确识别数学公式和方程
- **图形分析**：理解几何图形、图表等视觉元素
- **学科判断**：自动识别涉及的学科领域

### 🎯 教育专业
- **难度评估**：基础、中等、高级三个等级
- **解题指导**：提供详细的解题思路和步骤
- **知识关联**：关联相关知识点和概念
- **学习建议**：个性化的学习建议和练习推荐

### 🚀 用户体验
- **拖拽上传**：支持拖拽文件上传
- **实时预览**：上传后立即显示图片预览
- **进度提示**：分析过程中显示加载状态
- **错误处理**：友好的错误提示和重试机制

## 🔧 技术实现

### 核心组件
- `VisionAIService`：视觉AI服务封装
- `ImageUpload`：图片上传组件
- `ChatInterface`：集成图片功能的聊天界面

### 服务选择策略
系统按以下优先级自动选择可用的视觉AI服务：
1. OpenAI GPT-4 Vision
2. Google Gemini Vision
3. Anthropic Claude Vision

### 错误处理
- API 密钥验证
- 文件格式检查
- 文件大小限制
- 网络错误重试
- 服务降级处理

## 💡 使用建议

### 最佳实践
1. **清晰拍照**：确保图片清晰，文字可读
2. **合适角度**：正面拍摄，避免倾斜
3. **充足光线**：保证图片亮度适中
4. **完整内容**：包含完整的题目信息

### 支持的题目类型
- ✅ 数学计算题
- ✅ 几何证明题
- ✅ 物理公式题
- ✅ 化学方程式
- ✅ 文字应用题
- ✅ 图表分析题

### 注意事项
- 手写内容识别准确度可能略低于印刷体
- 复杂的多步骤题目建议分步提问
- 如果识别有误，可以手动输入文字进行补充

## 🔮 未来规划

### 即将推出
- **批量上传**：支持一次上传多张图片
- **OCR 优化**：提升手写文字识别准确度
- **语音输入**：结合图片的语音问答
- **历史记录**：保存分析过的图片和结果

### 长期规划
- **DeepSeek 多模态**：等待 DeepSeek 官方支持图片功能
- **本地 OCR**：集成本地文字识别减少 API 调用
- **AR 功能**：实时相机识别和分析
- **协作功能**：支持图片分享和讨论

## 🆘 常见问题

### Q: 为什么不直接使用 DeepSeek 分析图片？
A: DeepSeek API 目前不支持多模态输入，官方文档明确说明"当前版本暂不支持多模态输入输出"。

### Q: 哪个视觉 AI 服务效果最好？
A: 推荐使用 OpenAI GPT-4 Vision，在数学公式识别和理解方面表现最佳。

### Q: 图片分析需要额外费用吗？
A: 是的，视觉 AI 服务通常按 API 调用次数收费，建议查看各服务商的定价政策。

### Q: 支持哪些图片格式？
A: 目前支持 JPG、PNG、WebP 格式，最大文件大小 10MB。

### Q: 如果所有视觉 AI 服务都不可用怎么办？
A: 系统会提示用户手动输入题目内容，或者稍后重试。

---

📧 如有问题或建议，请联系开发团队！
